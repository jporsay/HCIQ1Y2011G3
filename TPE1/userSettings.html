<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="stylesheet" type="text/css" href="css/userSettingsPage.css">
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<link rel="stylesheet" type="text/css" href="css/navbar.css">
	<link rel="stylesheet" type="text/css" href="css/categories.css">
	<link rel="stylesheet" type="text/css" href="css/header.css">
	<link rel="stylesheet" type="text/css" href="css/jquery-ui-1.8.11.custom.css">
	<link rel="stylesheet" type="text/css" href="css/Base.css">
	<link rel="stylesheet" type="text/css" href="css/BreadCrumb.css">
	<link rel="stylesheet" type="text/css" href="css/footer.css">
	<link rel="stylesheet" type="text/css" href="css/cart.css">
	<script type="text/javascript" src="libs/init.js"></script>
	<script type="text/javascript" src="libs/jquery-1.5.1.min.js"></script>
	<script type="text/javascript" src="libs/jquery.easing.1.3.js"></script>
	<script type="text/javascript" src="libs/jquery.jBreadCrumb.1.1.js"></script>
	<script type="text/javascript" src="libs/jquery.cookie.js"></script>
	<script type="text/javascript" src="libs/jquery-ui-1.8.11.custom.min.js"></script>
	<script type="text/javascript" src="libs/i18n.js"></script>
	<script type="text/javascript" src="libs/ServerManager.js"></script>
	<script type="text/javascript" src="libs/categoriesManager.js"></script>
	<script type="text/javascript" src="libs/subcategoriesManager.js"></script>
	<script type="text/javascript" src="libs/itemManager.js"></script>
	<script type="text/javascript" src="libs/cartManager.js"></script>
	<script type="text/javascript" src="libs/userManager.js"></script>
	<script type="text/javascript" src="libs/login.js"></script>
	<script type="text/javascript" src="libs/country.js"></script>
	<script type="text/javascript" src="libs/userSettings.js"></script>
	<script type="text/javascript">
		$(function() {
			
			if (!getLoggedData()) {
				alert('You need to be logged in to access this area');
				window.location = 'index.html';
			}
			
			$("#breadcrumb").jBreadCrumb();
			
			var translator = new i18n();
			document.getElementById('locale').value = translator.getLang();
			
			$(document).keydown(function(e) {
				if (e.keyCode == 27) {
					if ($('.loginform').is(':visible') === true) {
						$('.loginform').hide();
					}
				}
			});
			
			$('.logintext').click(function() {
				if ($('.loginform').is(':visible') === false) {
					$('#loginimg').css("background-position", "0 -16px");
				} else {
					$('#loginimg').css("background-position", "-64px -16px");
				}
				$('.loginform').slideToggle();
			});
			
			$("#locale").change(function() {
				translator.setLang($(this).val());
				loadCategories($('#locale :selected').attr('id'));
				translator.translatePage();
			});

			$('#searchbutton').click(function() {
				if ($('#searchtext').val() != '') {
					window.location = 'browse.html?searchText=' + $('#searchtext').val();
				}
			});
			
			$('#searchtext').keydown(function(e) {
				if (e.keyCode === 13) {
					$('#searchbutton').click();
				}
			});
			
			loadCartFromCookie();
			cartInstance.update();
			loadCategories($('#locale :selected').attr('id'));
			loadUserSesion();
			getCountries($('#locale :selected').attr('id'));
			
			$('#addAddressForm').submit(function(e) {
				e.preventDefault();
				var countryId = $(document.getElementById('countryIdNA')).val();
				var stateId = $(document.getElementById('stateIdNA')).val();
				createAddress($('#addAddressForm input'), countryId, stateId);
			});
			
			$('#personalInfoForm').submit(function(e) {
				e.preventDefault();
				if ($('#nameInput').length > 80 || $('#nameInput').length < 1) {
					alert('invalid name');
					return;
				} else if (!$('#birthDateInput').val().match(/^(19|20)\d\d-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/)) {
					alert('invalid date');
					return;
				} else if (!$('#emailInput').val().match(/^[\w\d_-]+@[\w\d_-]+\.[\w]+$/)) {
					alert('invalid email');
					return;
				}
				updateUserData($('#nameInput').val(), $('#birthDateInput').val(), $('#emailInput').val());
			});
			
			$('#updateAddressForm').submit(function(e) {
				e.preventDefault();
				updateExistingAddress();
			});
			
			$('#passwordChangeForm').submit(function(e) {
				e.preventDefault();
				var newP = $('#newPassword').val();
				if (newP.length < 8) {
					alert('Password too short');
					return;
				}
				changePassword($('#oldPassword').val(), $('#newPassword').val());
			});
			
			getAddressList(getAddressListCallback);
			getUserData();
			translator.translatePage();
		});
	</script>
	
	<title>Carritus Co.</title>
</head>
<body>
	<div class="header">
		<img src="images/cooltext530131064.png" alt="Company Logo" width="276" height="110">
		<h1 id='header'>Happy Business</h1>
		<div id="localization">
		</div>
		<div id="login">
			<div class="logintext">
				<div id="loginimg"></div>
				<span id="logintext" class="i18n"></span>
			</div>
			<div class="loginform">
			</div>
		</div>
		<div class="navbar">
			<div id="breadcrumbholder" class="breadCrumbHolder breadCrumbPosition breadCrumb module">
				<ul id="breadcrumb">
					<li><a href="index.html" class='i18n' id='bcHome'>Home</a></li>
					<li class='i18n' id='bcBrowse'>Browse</li>
				</ul>
			</div>
			<div id="searchbar">
				<input id="searchtext" class="i18n" value="Search" onfocus="if(!this._haschanged){this.value=''};this._haschanged=true;">
				<button id="searchbutton" class="ui-widget">Go</button>
			</div>
		</div>
	</div>
	
	<div id="mainArea">
		<div id="leftArea">
			<div id="categoryNav">
				<div id="leftNavContainer">
					<div id="refinements">
						<h2 id='categoryHeader' class='i18n'></h2>
				 	</div>
				</div>
			</div>
			<div id='settingsPanel'>
				<h1 class='title'>Your settings:</h1>
					<form id='personalInfoForm'>
						<fieldset>
							<tr>
							<legend>Personal Information</legend>
							<div class='fieldRow'>
								<span>Nombre completo:</span>
								<input type='text' id='nameInput'></input>
							</div>
							<div class='fieldRow'>
								<span>Email:</span>
								<input type='text' id='emailInput'></input>
							</div>
							<div class='fieldRow'>
								<span>Fecha de nacimiento:</span>
								<input type='text' id='birthDateInput'></input>
							</div>
						<input type="submit" class="submit" value='Guardar'></input>
						</fieldset>
					</form>
					<form id='passwordChangeForm'>
						<fieldset>
							<tr>
							<legend>Password Management</legend>
							<div class='fieldRow'>
								<span>Old Password:</span>
								<input type='password' id='oldPassword'></input>
							</div>
							<div class='fieldRow'>
								<span>New Password:</span>
								<input type='password' id='newPassword'></input>
							</div>
						<input type="submit" class="submit" value="Guardar"></input>
						</fieldset>
					</form>

					<fieldset>
						<legend>Addressing information</legend>
						<ul>
							<li><a href="#">Add Address</a></li>
							<li><a href="#">Check Addresses</a></li>
						</ul>
					</fieldset>
					<!--ESTO SERIA AGREGADO CUNADO SE PRESIONA EL BOTON ADD ADDRESS -->
					<form id='addAddressForm'>
						<fieldset class='addressFieldSet'>
							<legend>New Address</legend>
							<div class='fieldRow'>
								<span>Name:</span>
								<input type='text' id='fullName'></input>
							</div>
							<div class='fieldRow'>
								<span>Adress 1:</span>
								<input id='addressLineOne' type='text'></input>
							</div>
							<div class='fieldRow'>
								<span>Adress 2:</span>
								<input id='addressLineTwo' type='text'></input>
							</div>
							<div class='fieldRow' id='countryDivNA'>
								<span>County:</span>
							</div>
							<div class='fieldRow' id='stateDivNA'>
								<span>State:</span>
							</div>
							<div class='fieldRow'>
								<span>City:</span>
								<input id='city' type='text'></input>
							</div>
							<div class='fieldRow'>
								<span>Zip Code:</span>
								<input id='zipCode' type='text'></input>
							</div>
							<div class='fieldRow'>
								<span>Phone Number:</span>
								<input id='phoneNumber' type='text'></input>
							</div>
						<button type='cancel'>Cancel</button>
						<button type="submit" class="submit" id='newAddressSubmit'>Guardar</button>
						</fieldset>
					</form>
					<!---------------------------------------------------------------->
					
					
					<!--ESTO SERIA AGREGADO CUNADO SE PRESIONA EL BOTON CHECK ADDRESSES -->
					<form id='updateAddressForm'>
						<fieldset class="checkAddress">
							<legend>These are your current addresses:</legend>
							<select id="AddressSelect">
								<option value="1">item 1</option>
								<option value="2">item 2</option>
								<option value="3">item 3</option>
								<option value="4">item 4</option>
							</select>
							<div class='fieldRow'>
								<span>Adress 1:</span>
								<input type='text' id='maAddress1'></input>
							</div>
							<div class='fieldRow'>
								<span>Adress 2:</span>
								<input type='text' id='maAddress2'></input>
							</div>
							<div class='fieldRow' id='countryDivMA'>
								<span>County:</span>
							</div>
							<div class='fieldRow' id='stateDivMA'>
								<span>State:</span>
							</div>
							<div class='fieldRow'>
								<span>City:</span>
								<input type='text' id='maCity'></input>
							</div>
							<div class='fieldRow'>
								<span>Zip Code:</span>
								<input type='text' id='maZipCode'></input>
							</div>
							<div class='fieldRow'>
								<span>Phone Number:</span>
								<input type='text' id='maPhoneNumber'></input>
							</div>
							<button type="cancel" class="">Cancel</button>
							<input type="submit" class="submit" value='Guardar' id='updateAddress'></input>
						</fieldset>
					</form>
					<!---------------------------------------------------------------->
			</div>
		</div>
		<div id="rightArea">
			<div class="cartHolder"></div>
		</div>
	</div>
</body>
</html>
