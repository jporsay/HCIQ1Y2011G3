function loadSpanish() {
	langKeys = [];
	//Common
	langKeys['logintext'] = 'Loguearse';
	langKeys['usernameText'] = 'Usuario:';
	langKeys['passwordText'] = 'Contrase&ntilde;a:';
	langKeys['searchtext'] = 'Buscar';
	langKeys['categoryHeader'] = 'Categor&iacute;as';
	langKeys['createaccount'] = 'Crear cuenta';
	langKeys['errorContainer'] = 'Usuario o contrase&ntilde;a inv&aacute;lido';
	langKeys['registerLink'] = 'Registrarse';
	
	//Validation Errors
	//User
	langKeys['passwordFormat'] = 'Largo: Min: 8, Max: 15';
	langKeys['mailFormat'] = 'Formato: great@example.com';
	langKeys['usernameFormat'] = 'Solo letras y d&iacute;gitos. Max: 15';
	langKeys['nameFormat'] = 'Solo letras y espacios. Max: 80';
	langKeys['dateFormat'] = 'Formato: yyyy-mm-dd';
	//Address
	
	//Index
	langKeys['hotItemsHeader'] = 'Art&iacute;culos del dia:';
	
	//Cart
	langKeys['cartQuantity'] = 'Cantidad: ';
	langKeys['cartItemsHeader'] = 'Items del Carrito:';
	langKeys['cartCheckoutLink'] = 'Realizar el checkout!';
	langKeys['loginNeeded'] = 'Necesita estar logeado para acceder a esta pagina';
	langKeys['emtyCheckout'] = 'No puede realizar una compra vacia';
	
	//Register - User settings
	langKeys['registerHeader'] = 'Registro';
	langKeys['registerInfo'] = 'Por favor complete la informaci&oacute;n (todos los campos son obligatorios)';
	langKeys['registerUserName'] = 'Usuario:';
	langKeys['registerBirthDate'] = 'Fecha de nacimiento:';
	langKeys['registerFullName'] = 'Nombre completo:';
	langKeys['registerPassword'] = 'Contrase&ntilde;a:';
	langKeys['registerEmail'] = 'Email:';
	
	//Browse
	langKeys['productsHeader'] = 'Productos:';
	langKeys['browseRanking'] = 'Ranking: ';
	langKeys['pagePosition'] = 'P&aacute;gina '
	langKeys['pagePositionSeparator'] = ' de ';
	
	//BreadCrumb
	langKeys['bcHome'] = 'Inicio';
	langKeys['bcSettings'] = 'Configuraci&oacute;n';
	langKeys['bcBrowse'] = 'Productos';
	langKeys['bcRegister'] = 'Registrarse';
	langKeys['bcOrders'] = '&Oacute;rdenes';
	langKeys['bcMap'] = 'Mapa';
	
	//Product
	langKeys['pAddToCart'] = 'A&ntilde;adir al carrito';
	langKeys['pRemoveFromCart'] = 'Quitar del carrito';
	langKeys['pPrice'] = 'Precio: ';
	langKeys['format'] = 'Formato: ';
	langKeys['language'] = 'Idioma: ';
	langKeys['subtitles'] = 'Subt&iacute;tulos: ';
	langKeys['region'] = 'Regi&oacute;n: ';
	langKeys['aspect_ratio'] = 'Aspecto: ';
	langKeys['number_discs'] = 'Discos: ';
	langKeys['release_date'] = 'Fecha de publicación: ';
	langKeys['run_time'] = 'Duraci&oacute;n: ';
	langKeys['authors'] = 'Autores: ';
	langKeys['publisher'] = 'Publicador: ';
	langKeys['published_date'] = 'Fecha de publicaci&oacute;n: ';
	
	//Settings
	langKeys['passwordChangeOk'] = 'Contrase&ntilde;a actualizada';
	langKeys['passwordChangeFail'] = 'Contrase&ntilde;a incorrecta';
	langKeys['settingsChanged'] = 'Informaci&oacute;n personal actualizada';
	langKeys['addressAdded'] = 'Direcci&oacute;n agregada';
	langKeys['addressChanged'] = 'Direcci&oacute;n actualizada';
	langKeys['settingsError'] = 'Campos con * son obligatorios';
	langKeys['pswLegend'] = 'Cambio de contrase&ntilde;a';
	langKeys['addAdrsLegend'] = 'Nueva direccion';
	langKeys['currAdrsLegend'] = 'Direcciones ya existentes';
	langKeys['ucChkAdrs'] = 'Ver direcciones actuales';
		
	//Settings - changeUserData
	langKeys['ucFullName'] = 'Nombre completo:*';
	langKeys['ucEmail'] = 'Email:*';
	langKeys['ucBirthDate'] = 'Fecha de nacimiento:*';
	langKeys['ucLegend'] = 'Informaci&oacute;n personal';
	langKeys['adrsLegend'] = 'Direcciones';
	langKeys['ucAddAdrs'] = 'Agregar direccion';
	
	//Settings - changePassword
	langKeys['cpOldPassword'] = 'Contrase&ntilde;a actual:*';
	langKeys['cpNewPassword'] = 'Contrase&ntilde;a nueva:*';
	
	//Settings - addAddress
	langKeys['aaName'] = 'Nombre:*';
	langKeys['aaAddressOne'] = 'Direcci&oacute;n 1:*';
	langKeys['aaAddressTwo'] = 'Direcci&oacute;n 2:*';
	langKeys['aaZipCode'] = 'C&oacute;digo postal:*';
	langKeys['aaCity'] = 'Ciudad:*';
	langKeys['aaState'] = 'Estado:*';
	langKeys['aaPhoneNumber'] = 'N&uacute;mero de tel&eacute;fono:*';
	langKeys['aaCountry'] = 'Pa&iacute;s:*';
	
	//Settings - changeAddress
	langKeys['caAddressOne'] = 'Direcci&oacute;n 1:*';
	langKeys['caAddressTwo'] = 'Direcci&oacute;n 2:*';
	langKeys['caZipCode'] = 'C&oacute;digo postal:*';
	langKeys['caCity'] = 'Ciudad:*';
	langKeys['caState'] = 'Estado:*';
	langKeys['caPhoneNumber'] = 'N&uacute;mero de tel&eacute;fono:*';
	langKeys['caCountry'] = 'Pa&iacute;s:*';
	langKeys['selectAValidAddress'] = 'Elija o cree una direcci&oacute;n';
	
	//Map
	langKeys['mapTitle'] = 'Posici&oacute;n de la orden:';
	
	//Order tracking
	langKeys['confirmedOrdersHeader'] = 'Ordenes confirmadas:';
	langKeys['shippedOrdersHeader'] = 'Ordenes enviadas:';
	langKeys['deliveredOrdersHeader'] = 'Ordenes recibidas:';
	
	//Table Strings
	langKeys['tSubTotal'] = 'Subtotal';
	langKeys['tProduct'] = 'Producto';
	langKeys['tPrice'] = 'Precio';
	langKeys['tQuantity'] = 'Cantidad';
	langKeys['tTotal'] = 'Total:';
	
	//Checkout
	langKeys['checkoutRequiredInformation'] = 'Ingrese los datos requeridos para completar su orden';
	langKeys['checkoutLocationDelivery'] = 'Elija la dirección a la cual quiere que se entregue su orden:';
	langKeys['checkoutCreateAddress'] = 'Crear nueva dirección de envio';
	
	return langKeys;
}

i18n.prototype.hasTranslation = function(key) {
	return this.langKeys[key];
}

function loadEnglish() {
	langKeys = [];
	//Common
	langKeys['logintext'] = 'Login';
	langKeys['usernameText'] = 'Username:';
	langKeys['passwordText'] = 'Password:';
	langKeys['searchtext'] = 'Search';
	langKeys['categoryHeader'] = 'Categories';
	langKeys['createaccount'] = 'Create account';
	langKeys['errorContainer'] = 'Invalid username or password';
	langKeys['registerLink'] = 'Register';
	
	//Validation Errors
	//User
	langKeys['passwordFormat'] = 'Length. Min: 8. Max: 15';
	langKeys['mailFormat'] = 'Format: great@example.com';
	langKeys['usernameFormat'] = 'Only characters and digits. Max: 15';
	langKeys['nameFormat'] = 'Only letters and spaces. Max: 80';
	langKeys['dateFormat'] = 'Format: yyyy-mm-dd';
	
	//Index
	langKeys['hotItemsHeader'] = 'Today\'s hot items:'
	
	//Cart
	langKeys['cartQuantity'] = 'Quantity: ';
	langKeys['cartItemsHeader'] = 'Cart Items:';
	langKeys['cartCheckoutLink'] = 'Proceed to checkout!';
	langKeys['loginNeeded'] = 'You need to be logged in to access this page';
	langKeys['emtyCheckout'] = 'You can\'t checkout an empty cart!';
	
	//Register - User settings
	langKeys['registerHeader'] = 'Registration';
	langKeys['registerInfo'] = 'Please enter the required information (all fields are required)';
	langKeys['registerUserName'] = 'User:';
	langKeys['registerBirthDate'] = 'Birth Date:';
	langKeys['registerFullName'] = 'Full name:';
	langKeys['registerPassword'] = 'Password:';
	langKeys['registerEmail'] = 'Email:';
	langKeys['pswLegend'] = 'Password Management';
	langKeys['currAdrsLegend'] = 'These are your current addresses';
	langKeys['ucAddAdrs'] = 'Add address';
	langKeys['ucChkAdrs'] = 'Check addresses';
	
	//Browse
	langKeys['productsHeader'] = 'Products:';
	langKeys['browseRanking'] = 'Ranking: ';
	langKeys['pagePosition'] = 'Page '
	langKeys['pagePositionSeparator'] = ' of ';
	
	//BreadCrumb
	langKeys['bcHome'] = 'Home';
	langKeys['bcSettings'] = 'Settings';
	langKeys['bcBrowse'] = 'Products';
	langKeys['bcRegister'] = 'Register';
	langKeys['bcOrders'] = 'Orders';
	langKeys['bcMap'] = 'Map';
	
	//Product
	langKeys['pAddToCart'] = 'Add to cart';
	langKeys['pRemoveFromCart'] = 'Remove from cart';
	langKeys['pPrice'] = 'Price: ';
	langKeys['format'] = 'Format: ';
	langKeys['language'] = 'Language: ';
	langKeys['subtitles'] = 'Subtitles: ';
	langKeys['region'] = 'Region: ';
	langKeys['aspect_ratio'] = 'Aspect Ratio: ';
	langKeys['number_discs'] = 'Discs: ';
	langKeys['release_date'] = 'Release date: ';
	langKeys['run_time'] = 'Run time: ';
	langKeys['authors'] = 'Authors: ';
	langKeys['publisher'] = 'Publisher: ';
	langKeys['published_date'] = 'Published date: ';
	
	//Settings
	langKeys['passwordChangeOk'] = 'Password updated';
	langKeys['passwordChangeFail'] = 'Incorrect password';
	langKeys['settingsChanged'] = 'Personal information updated';
	langKeys['addressAdded'] = 'Address added';
	langKeys['addressChanged'] = 'Address updated';
	langKeys['settingsError'] = 'Fields with * are obligatory';
	langKeys['addAdrsLegend'] = 'Add address';
	langKeys['chkAdrsLegend'] = 'check address';
	
	//Settings - changeUserData
	langKeys['ucFullName'] = 'Full name:*';
	langKeys['ucEmail'] = 'Email:*';
	langKeys['ucBirthDate'] = 'Birth Date:*';
	langKeys['ucLegend'] = 'Personal Information';
	
	//Settings - changePassword
	langKeys['cpOldPassword'] = 'Old password:*';
	langKeys['cpNewPassword'] = 'New Password:*';
	
	//Settings - addAddress
	langKeys['aaName'] = 'Name:*';
	langKeys['aaAddressOne'] = 'Address 1:*';
	langKeys['aaAddressTwo'] = 'Address 2:*';
	langKeys['aaZipCode'] = 'Postal code:*';
	langKeys['aaCity'] = 'City:*';
	langKeys['aaState'] = 'State:*';
	langKeys['aaPhoneNumber'] = 'Phone number:*';
	langKeys['aaCountry'] = 'Country:*';
	
	//Settings - changeAddress
	langKeys['caAddressOne'] = 'Address 1:*';
	langKeys['caAddressTwo'] = 'Address 2:*';
	langKeys['caZipCode'] = 'Postal code:*';
	langKeys['caCity'] = 'City:*';
	langKeys['caState'] = 'State:*';
	langKeys['caPhoneNumber'] = 'Phone number:*';
	langKeys['caCountry'] = 'Country:*';
	langKeys['selectAValidAddress'] = 'Choose or create an address';
	
	//Map
	langKeys['mapTitle'] = 'Order location:';
	
	//Order tracking
	langKeys['confirmedOrdersHeader'] = 'Confirmed orders:';
	langKeys['shippedOrdersHeader'] = 'Shipped orders:';
	langKeys['deliveredOrdersHeader'] = 'Delivered orders:';
	
	//Table Strings
	langKeys['tSubTotal'] = 'Subtotal';
	langKeys['tProduct'] = 'Product';
	langKeys['tPrice'] = 'Price';
	langKeys['tQuantity'] = 'Quantity';
	langKeys['tTotal'] = 'Total:';
	return langKeys;
}

function processKey(key) {
	var pkey = key;
	if (key.search('cartQuantity') !== -1) {
		pkey = 'cartQuantity';
	}
	
	return pkey;
}

function getTranslation(key) {
	var keyp = processKey(key);
	return this.langKeys[keyp];
}

function i18n() {
	lang = $.cookie('hblanguage');
	if (lang == null) {
		lang = 'en';
	}
	fetchLanguages();
	this.setLang(lang);
}
var langData;
function fetchLanguages() {
	var common = new ServerManager('Common');
	if (langData == null) {
		common.getS({
			method: 'GetLanguageList'
		},
			setLanguages
		);
	} else {
		setLanguages(langData);
	}
}

function setLanguages(data) {
	langData = data;
	var optionHolder;
	if (document.getElementById('locale') === null) {
		optionHolder = document.createElement('select');
		optionHolder.setAttribute('id', 'locale');
		var holder = document.getElementById('localization');
		holder.appendChild(optionHolder);
		
		var option = null
		var first = true;
		$(data).find('language').each(
			function() {
				option = document.createElement('option');
				var code = $(this).find('code').text();
				option.id = $(this).attr('id');
				if (lang === code || (first === true && lang === null)) {
					option.setAttribute('selected', 'selected');
					first = false;
				}
				option.setAttribute('value', code);
				option.innerHTML = $(this).find('name').text();
				optionHolder.appendChild(option);
			}
		);
	}
}

i18n.prototype.getLang = function() {
	return this.lang;
}

i18n.prototype.getLangId = function() {
	return $('locale').attr('id');
}

i18n.prototype.setLang = function(language) {
	this.lang = language;
	this.langKeys = this.lang === 'en' ? loadEnglish() : loadSpanish()
	$.cookie('hblanguage', null);
	$.cookie('hblanguage', this.lang, {path: '/'});
}

i18n.prototype.translatePage = function() {
	var nodes = document.getElementsByClassName('i18n');
	
	for (var i = 0; i < nodes.length; ++i) {
		this.translateElement(nodes[i]);
	}
	
	return true;
}

i18n.prototype.translateElement = function(node) {
	var key = node.id;
	var translated = getTranslation(key);
	// not using getAttribute since its buggy.
	if (translated !== undefined) {
		if ($(node).is('input')) {
			//not using setAttribute since its broken in IE and in Opera.
			node.setAttribute('value', translated);
		} else {
			node.innerHTML = translated;
		}
	}
	
	return true;
}

